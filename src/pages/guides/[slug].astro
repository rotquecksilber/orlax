---
import MainLayout from '../../layouts/MainLayout.astro';
import Header from '../../components/Header.astro';
import { getEntryBySlug, getCollection } from 'astro:content';

export async function getStaticPaths() {
  // получаем все записи коллекции "guides"
  const guides = await getCollection('guides');

  return guides.map((guide) => ({
    params: { slug: guide.slug },
  }));
}

const { slug } = Astro.params;
const entry = await getEntryBySlug('guides', slug);

if (!entry) {
  throw new Error('Guide not found');
}

const rendered = await entry.render();
---

<MainLayout title={entry.data.title} description={entry.data.description}>
  <Header />
  <article>
    {rendered.Content && <rendered.Content />}
  </article>
</MainLayout>
